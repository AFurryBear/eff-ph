
[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
    5 | #include <nvrtc.h>
      |          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /raven/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/raven/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
    6 | #include <nvrtc.h>
      |          ^~~~~~~~~
compilation terminated.

OK
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_euclidean
Computing PH for toy_circle with sigma 0.0 and distance euclidean with {}
Writing dists for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_euclidean
Running Ripser for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_euclidean


Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_1
Computing PH for toy_circle with sigma 0.0 and distance fermat with {'p': 1}
Writing dists for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_1
Running Ripser for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_1


Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_2
Computing PH for toy_circle with sigma 0.0 and distance fermat with {'p': 2}
Writing dists for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_2
Running Ripser for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_2


Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_3
Computing PH for toy_circle with sigma 0.0 and distance fermat with {'p': 3}
Writing dists for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_3
Running Ripser for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_3


Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_5
Computing PH for toy_circle with sigma 0.0 and distance fermat with {'p': 5}
Writing dists for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_5
Running Ripser for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_5


Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_7
Computing PH for toy_circle with sigma 0.0 and distance fermat with {'p': 7}
Writing dists for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_7
Running Ripser for toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_7


Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_dtm_k_4_p_dtm_2_p_radius_1
Computing PH for toy_circle with sigma 0.0 and distance dtm with {'k': 4, 'p_dtm': 2, 'p_radius': 1}

[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
    5 | #include <nvrtc.h>
      |          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /raven/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/raven/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
    6 | #include <nvrtc.h>
      |          ^~~~~~~~~
compilation terminated.

OK
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_euclidean
Computing PH for toy_circle with sigma 0.0 and distance euclidean with {}
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_1
Computing PH for toy_circle with sigma 0.0 and distance fermat with {'p': 1}
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_2
Computing PH for toy_circle with sigma 0.0 and distance fermat with {'p': 2}
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_3
Computing PH for toy_circle with sigma 0.0 and distance fermat with {'p': 3}
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_5
Computing PH for toy_circle with sigma 0.0 and distance fermat with {'p': 5}
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_fermat_p_7
Computing PH for toy_circle with sigma 0.0 and distance fermat with {'p': 7}
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_dtm_k_4_p_dtm_2_p_radius_1
Computing PH for toy_circle with sigma 0.0 and distance dtm with {'k': 4, 'p_dtm': 2, 'p_radius': 1}
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_dtm_k_4_p_dtm_2_p_radius_1
Computing PH for toy_circle with sigma 0.0 and distance dtm with {'k': 4, 'p_dtm': 2, 'p_radius': 1}
[pyKeOps] Initializing build folder for dtype=float64 and lang=torch in /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0 ... done.
[pyKeOps] Compiling libKeOpstorch3a16326667 in /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0:
       formula: KMin_Reduction(Sum(Square((Var(0,2,0) - Var(1,2,1)))),5,1)
       aliases: Var(0,2,0); Var(1,2,1); 
       dtype  : float64
... 
[pyKeOps] Compiling pybind11 template libKeOps_template_33ebbbf34e in /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0 ... 
--------------------- MAKE DEBUG -----------------
Command '['cmake', '--build', '.', '--target', 'libKeOps_template_33ebbbf34e', '--', 'VERBOSE=1']' returned non-zero exit status 2.
/usr/bin/cmake -S/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template -B/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/gmake  -f CMakeFiles/Makefile2 libKeOps_template_33ebbbf34e
gmake[1]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/cmake -S/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template -B/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/cmake -E cmake_progress_start /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e/CMakeFiles 2
/usr/bin/gmake  -f CMakeFiles/Makefile2 CMakeFiles/libKeOps_template_33ebbbf34e.dir/all
gmake[2]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/gmake  -f CMakeFiles/libKeOps_template_33ebbbf34e.dir/build.make CMakeFiles/libKeOps_template_33ebbbf34e.dir/depend
gmake[3]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
cd /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e/CMakeFiles/libKeOps_template_33ebbbf34e.dir/DependInfo.cmake --color=
gmake[3]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/gmake  -f CMakeFiles/libKeOps_template_33ebbbf34e.dir/build.make CMakeFiles/libKeOps_template_33ebbbf34e.dir/build
gmake[3]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
[ 50%] Building CXX object CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o
/mpcdf/soft/SLE_15/packages/x86_64/gcc/11.2.0/bin/c++ -DCUDA_BLOCK_SIZE=192 -DC_CONTIGUOUS=1 -DMAXIDGPU=0 -DMAXTHREADSPERBLOCK0=1024 -DMODULE_NAME=libKeOps_template_33ebbbf34e -DSHAREDMEMPERBLOCK0=49152 -DUSE_CUDA=1 -DUSE_DOUBLE=1 -DUSE_HALF=0 -D_FORCE_INLINES -D_GLIBCXX_USE_CXX11_ABI=1 -D__TYPE__=double -DlibKeOps_template_33ebbbf34e_EXPORTS -I/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template/../.. -I/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e -I/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template/../../keops -I/mpcdf/soft/SLE_15/packages/x86_64/cuda/11.6.2/targets/x86_64-linux/include -I/mpcdf/soft/SLE_15/packages/skylake/pytorch/gpu-cuda-11.6/anaconda_3_2021.11-2021.11/2.0.0/lib/python3.9/site-packages/torch/include -I/mpcdf/soft/SLE_15/packages/skylake/pytorch/gpu-cuda-11.6/anaconda_3_2021.11-2021.11/2.0.0/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /mpcdf/soft/SLE_15/packages/x86_64/anaconda/3/2021.11/include/python3.9 -isystem /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/pybind11/include -DUSE_OPENMP -fopenmp -Wall -Wno-unknown-pragmas -fmax-errors=2 -O3 -DNDEBUG -O3 -fPIC -fvisibility=hidden -include torch_headers.h -flto -fno-fat-lto-objects -std=gnu++14 -MD -MT CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o -MF CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o.d -o CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o -c /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp
gmake[3]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
gmake[2]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
gmake[1]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'

--------------------- ----------- -----------------
done.
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_dtm_k_4_p_dtm_2_p_radius_1
Computing PH for toy_circle with sigma 0.0 and distance dtm with {'k': 4, 'p_dtm': 2, 'p_radius': 1}
[pyKeOps] Compiling libKeOpstorch3a16326667 in /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0:
       formula: KMin_Reduction(Sum(Square((Var(0,2,0) - Var(1,2,1)))),5,1)
       aliases: Var(0,2,0); Var(1,2,1); 
       dtype  : float64
... 

--------------------- MAKE DEBUG -----------------
Command '['cmake', '--build', '.', '--target', 'libKeOps_template_33ebbbf34e', '--', 'VERBOSE=1']' returned non-zero exit status 2.
/usr/bin/cmake -S/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template -B/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/gmake  -f CMakeFiles/Makefile2 libKeOps_template_33ebbbf34e
gmake[1]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/cmake -S/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template -B/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/cmake -E cmake_progress_start /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e/CMakeFiles 2
/usr/bin/gmake  -f CMakeFiles/Makefile2 CMakeFiles/libKeOps_template_33ebbbf34e.dir/all
gmake[2]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/gmake  -f CMakeFiles/libKeOps_template_33ebbbf34e.dir/build.make CMakeFiles/libKeOps_template_33ebbbf34e.dir/depend
gmake[3]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
cd /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e/CMakeFiles/libKeOps_template_33ebbbf34e.dir/DependInfo.cmake --color=
gmake[3]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/gmake  -f CMakeFiles/libKeOps_template_33ebbbf34e.dir/build.make CMakeFiles/libKeOps_template_33ebbbf34e.dir/build
gmake[3]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
[ 50%] Building CXX object CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o
/mpcdf/soft/SLE_15/packages/x86_64/gcc/11.2.0/bin/c++ -DCUDA_BLOCK_SIZE=192 -DC_CONTIGUOUS=1 -DMAXIDGPU=0 -DMAXTHREADSPERBLOCK0=1024 -DMODULE_NAME=libKeOps_template_33ebbbf34e -DSHAREDMEMPERBLOCK0=49152 -DUSE_CUDA=1 -DUSE_DOUBLE=1 -DUSE_HALF=0 -D_FORCE_INLINES -D_GLIBCXX_USE_CXX11_ABI=1 -D__TYPE__=double -DlibKeOps_template_33ebbbf34e_EXPORTS -I/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template/../.. -I/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e -I/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template/../../keops -I/mpcdf/soft/SLE_15/packages/x86_64/cuda/11.6.2/targets/x86_64-linux/include -I/mpcdf/soft/SLE_15/packages/skylake/pytorch/gpu-cuda-11.6/anaconda_3_2021.11-2021.11/2.0.0/lib/python3.9/site-packages/torch/include -I/mpcdf/soft/SLE_15/packages/skylake/pytorch/gpu-cuda-11.6/anaconda_3_2021.11-2021.11/2.0.0/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /mpcdf/soft/SLE_15/packages/x86_64/anaconda/3/2021.11/include/python3.9 -isystem /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/pybind11/include -DUSE_OPENMP -fopenmp -Wall -Wno-unknown-pragmas -fmax-errors=2 -O3 -DNDEBUG -O3 -fPIC -fvisibility=hidden -include torch_headers.h -flto -fno-fat-lto-objects -std=gnu++14 -MD -MT CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o -MF CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o.d -o CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o -c /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp
gmake[3]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
gmake[2]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
gmake[1]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'

--------------------- ----------- -----------------
/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e
libKeOps_template_33ebbbf34e*.so

[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
    5 | #include <nvrtc.h>
      |          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /raven/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/raven/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
    6 | #include <nvrtc.h>
      |          ^~~~~~~~~
compilation terminated.

OK
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_dtm_k_4_p_dtm_2_p_radius_1
Computing PH for toy_circle with sigma 0.0 and distance dtm with {'k': 4, 'p_dtm': 2, 'p_radius': 1}

[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
    5 | #include <nvrtc.h>
      |          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /raven/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/raven/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
    6 | #include <nvrtc.h>
      |          ^~~~~~~~~
compilation terminated.

OK
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_dtm_k_4_p_dtm_2_p_radius_1
Computing PH for toy_circle with sigma 0.0 and distance dtm with {'k': 4, 'p_dtm': 2, 'p_radius': 1}

[KeOps] Warning : There were warnings or errors compiling formula :
<stdin>:1:10: fatal error: cuda.h: No such file or directory
compilation terminated.

[KeOps] Warning : 
    The location of Cuda header files cuda.h and nvrtc.h could not be detected on your system.
    You must determine their location and then define the environment variable CUDA_PATH,
    either before launching Python or using os.environ before importing keops. For example
    if these files are in /vol/cuda/10.2.89-cudnn7.6.4.38/include you can do :
      import os
      os.environ['CUDA_PATH'] = '/vol/cuda/10.2.89-cudnn7.6.4.38'
    
[KeOps] Compiling cuda jit compiler engine ... 
[KeOps] Warning : There were warnings or errors compiling formula :
/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/keopscore/binders/nvrtc/nvrtc_jit.cpp:5:10: fatal error: nvrtc.h: No such file or directory
    5 | #include <nvrtc.h>
      |          ^~~~~~~~~
compilation terminated.

OK
[pyKeOps] Compiling nvrtc binder for python ... 
[KeOps] Warning : There were warnings or errors compiling formula :
In file included from /raven/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/common/keops_io/pykeops_nvrtc.cpp:4:
/raven/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/keopscore/binders/nvrtc/keops_nvrtc.cpp:6:10: fatal error: nvrtc.h: No such file or directory
    6 | #include <nvrtc.h>
      |          ^~~~~~~~~
compilation terminated.

OK
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_dtm_k_4_p_dtm_2_p_radius_1
Computing PH for toy_circle with sigma 0.0 and distance dtm with {'k': 4, 'p_dtm': 2, 'p_radius': 1}
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_dtm_k_4_p_dtm_2_p_radius_1
Computing PH for toy_circle with sigma 0.0 and distance dtm with {'k': 4, 'p_dtm': 2, 'p_radius': 1}
[pyKeOps] Compiling libKeOpstorch3a16326667 in /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0:
       formula: KMin_Reduction(Sum(Square((Var(0,2,0) - Var(1,2,1)))),5,1)
       aliases: Var(0,2,0); Var(1,2,1); 
       dtype  : float64
... 

--------------------- MAKE DEBUG -----------------
Command '['cmake', '--build', '.', '--target', 'libKeOps_template_33ebbbf34e', '--', 'VERBOSE=1']' returned non-zero exit status 2.
/usr/bin/cmake -S/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template -B/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e --check-build-system CMakeFiles/Makefile.cmake 0
Re-run cmake file: Makefile older than: /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/pybind11/tools/pybind11Tools.cmake
-- The CUDA Host CXX Compiler: /mpcdf/soft/SLE_15/packages/x86_64/gcc/11.2.0/bin/c++
-- Compute properties automatically set to: -DMAXIDGPU=0;-DMAXTHREADSPERBLOCK0=1024;-DSHAREDMEMPERBLOCK0=49152
-- Autodetected CUDA architecture(s):  8.0
-- pybind11 v2.6.1 
-- Configuring done
-- Generating done
-- Build files have been written to: /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e
/usr/bin/gmake  -f CMakeFiles/Makefile2 libKeOps_template_33ebbbf34e
gmake[1]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/cmake -S/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template -B/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/cmake -E cmake_progress_start /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e/CMakeFiles 2
/usr/bin/gmake  -f CMakeFiles/Makefile2 CMakeFiles/libKeOps_template_33ebbbf34e.dir/all
gmake[2]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/gmake  -f CMakeFiles/libKeOps_template_33ebbbf34e.dir/build.make CMakeFiles/libKeOps_template_33ebbbf34e.dir/depend
gmake[3]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
cd /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e/CMakeFiles/libKeOps_template_33ebbbf34e.dir/DependInfo.cmake --color=
gmake[3]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/gmake  -f CMakeFiles/libKeOps_template_33ebbbf34e.dir/build.make CMakeFiles/libKeOps_template_33ebbbf34e.dir/build
gmake[3]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
[ 50%] Building CXX object CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o
/mpcdf/soft/SLE_15/packages/x86_64/gcc/11.2.0/bin/c++ -DCUDA_BLOCK_SIZE=192 -DC_CONTIGUOUS=1 -DMAXIDGPU=0 -DMAXTHREADSPERBLOCK0=1024 -DMODULE_NAME=libKeOps_template_33ebbbf34e -DSHAREDMEMPERBLOCK0=49152 -DUSE_CUDA=1 -DUSE_DOUBLE=1 -DUSE_HALF=0 -D_FORCE_INLINES -D_GLIBCXX_USE_CXX11_ABI=1 -D__TYPE__=double -DlibKeOps_template_33ebbbf34e_EXPORTS -I/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template/../.. -I/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e -I/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template/../../keops -I/mpcdf/soft/SLE_15/packages/x86_64/cuda/11.6.2/targets/x86_64-linux/include -I/mpcdf/soft/SLE_15/packages/skylake/pytorch/gpu-cuda-11.6/anaconda_3_2021.11-2021.11/2.0.0/lib/python3.9/site-packages/torch/include -I/mpcdf/soft/SLE_15/packages/skylake/pytorch/gpu-cuda-11.6/anaconda_3_2021.11-2021.11/2.0.0/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /mpcdf/soft/SLE_15/packages/x86_64/anaconda/3/2021.11/include/python3.9 -isystem /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/pybind11/include -DUSE_OPENMP -fopenmp -Wall -Wno-unknown-pragmas -fmax-errors=2 -O3 -DNDEBUG -O3 -fPIC -fvisibility=hidden -include torch_headers.h -flto -fno-fat-lto-objects -std=gnu++14 -MD -MT CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o -MF CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o.d -o CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o -c /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp
gmake[3]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
gmake[2]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
gmake[1]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'

--------------------- ----------- -----------------
Starting with toy_circle_1000_d_2_ortho_gauss_sigma_0.0_seed_0_dtm_k_4_p_dtm_2_p_radius_1
Computing PH for toy_circle with sigma 0.0 and distance dtm with {'k': 4, 'p_dtm': 2, 'p_radius': 1}
[pyKeOps] Compiling libKeOpstorch3a16326667 in /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0:
       formula: KMin_Reduction(Sum(Square((Var(0,2,0) - Var(1,2,1)))),5,1)
       aliases: Var(0,2,0); Var(1,2,1); 
       dtype  : float64
... 

--------------------- MAKE DEBUG -----------------
Command '['cmake', '--build', '.', '--target', 'libKeOps_template_33ebbbf34e', '--', 'VERBOSE=1']' returned non-zero exit status 2.
/usr/bin/cmake -S/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template -B/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/gmake  -f CMakeFiles/Makefile2 libKeOps_template_33ebbbf34e
gmake[1]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/cmake -S/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template -B/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/cmake -E cmake_progress_start /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e/CMakeFiles 2
/usr/bin/gmake  -f CMakeFiles/Makefile2 CMakeFiles/libKeOps_template_33ebbbf34e.dir/all
gmake[2]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/gmake  -f CMakeFiles/libKeOps_template_33ebbbf34e.dir/build.make CMakeFiles/libKeOps_template_33ebbbf34e.dir/depend
gmake[3]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
cd /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e /raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e/CMakeFiles/libKeOps_template_33ebbbf34e.dir/DependInfo.cmake --color=
gmake[3]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
/usr/bin/gmake  -f CMakeFiles/libKeOps_template_33ebbbf34e.dir/build.make CMakeFiles/libKeOps_template_33ebbbf34e.dir/build
gmake[3]: Entering directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
[ 50%] Building CXX object CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o
/mpcdf/soft/SLE_15/packages/x86_64/gcc/11.2.0/bin/c++ -DCUDA_BLOCK_SIZE=192 -DC_CONTIGUOUS=1 -DMAXIDGPU=0 -DMAXTHREADSPERBLOCK0=1024 -DMODULE_NAME=libKeOps_template_33ebbbf34e -DSHAREDMEMPERBLOCK0=49152 -DUSE_CUDA=1 -DUSE_DOUBLE=1 -DUSE_HALF=0 -D_FORCE_INLINES -D_GLIBCXX_USE_CXX11_ABI=1 -D__TYPE__=double -DlibKeOps_template_33ebbbf34e_EXPORTS -I/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template/../.. -I/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e -I/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/cmake_scripts/script_template/../../keops -I/mpcdf/soft/SLE_15/packages/x86_64/cuda/11.6.2/targets/x86_64-linux/include -I/mpcdf/soft/SLE_15/packages/skylake/pytorch/gpu-cuda-11.6/anaconda_3_2021.11-2021.11/2.0.0/lib/python3.9/site-packages/torch/include -I/mpcdf/soft/SLE_15/packages/skylake/pytorch/gpu-cuda-11.6/anaconda_3_2021.11-2021.11/2.0.0/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /mpcdf/soft/SLE_15/packages/x86_64/anaconda/3/2021.11/include/python3.9 -isystem /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/pybind11/include -DUSE_OPENMP -fopenmp -Wall -Wno-unknown-pragmas -fmax-errors=2 -O3 -DNDEBUG -O3 -fPIC -fvisibility=hidden -include torch_headers.h -flto -fno-fat-lto-objects -std=gnu++14 -MD -MT CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o -MF CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o.d -o CMakeFiles/libKeOps_template_33ebbbf34e.dir/u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp.o -c /u/yxiong/eff-ph/.venv/lib/python3.9/site-packages/pykeops/torch/generic/generic_red.cpp
gmake[3]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
gmake[2]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'
gmake[1]: Leaving directory '/raven/u/yxiong/.cache/pykeops-1.5-cpython-39-gpu0/build-pybind11_template-libKeOps_template_33ebbbf34e'

--------------------- ----------- -----------------
[]
